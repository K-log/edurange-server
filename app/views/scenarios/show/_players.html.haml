%li
  %label
    Players
  %br
  - @scenario.groups.each do |group|
    %span.inline
      = "Group: " + group.name
      &nbsp&nbsp&nbsp
    %div.inline-block
      %div.dropdown{ id: "dropdown-group-" + group.id.to_s }
        %button.btn.btn-default.dropdown-toggle{type:'button', id:'dropdown-group-' + group.id.to_s, "data-toggle" => 'dropdown', "aria-expanded" => "true"}
          %span.caret
        %ul.dropdown-menu{role: 'menu', "aria-labelledby" => 'dropdown-group-' + group.id.to_s}
          %li{role: 'presentation'}
            = link_to 'Add Player', "#modal-add-player", :data => {:toggle=>"modal"}, onclick: "$('#modal-add-player').find('#title').html('#{group.name}: Add Player'); $('#modal-add-player').find('#group_id').val('#{group.id}'); $('#modal-add-player').find('#group').val('#{group.name}');"

          %li{role: 'presentation'}
            = link_to 'Add Student Group', "#modal-add-student-group", :data => {:toggle=>"modal"}, onclick: "$('#modal-add-student-group').find('#group_id').val('#{group.id}'); $('#modal-add-student-group').find('#group').text('#{group.name}')"

          %li{role: 'presentation'}
            = link_to 'Remove Student Group', "#modal-remove-student-group", :data => {:toggle=>"modal"}, onclick: "$('#modal-remove-student-group').find('#group_id').val('#{group.id}'); $('#modal-remove-student-group').find('#group').text('#{group.name}');"

    %br
    Administrator Access:
    - group.instance_groups.select{ |ig| ig.administrator == true }.each do |ig|
      = ig.instance.name
      = ig == group.instance_groups.select{ |ig| ig.administrator == true }.last ? "" : ","
    %br
    User Access:
    - group.instance_groups.select{ |ig| ig.administrator == false }.each do |ig|
      = ig.instance.name
      = ig == group.instance_groups.select{ |ig| ig.administrator == false }.last ? "" : ","
    %p

    %table.table{id: "players-table-group-" + group.id.to_s}
      %tr
        %th Name
        %th Email
        %th Student Group
        %th Login
        %th Password
        %th
      - group.players.each do |player|
        %tr{id: 'group-table-player-' + player.id.to_s}
          - if player.user_id
            - user = User.find(player.user_id)
            %td= user.name
            %td= user.email
          - else
            %td= "-"
            %td= "-"
          - if player.student_group_id
            %td= player.student_group.name
          - else
            %td= '-'

          %td= player.login
          %td= player.password
          %td= link_to 'delete', player_delete_scenario_path(player_id: player), remote: true, method: :post
          
Roles: 
  - Name: NAT
    Recipes:
      - strace
      - sshd_password_login
  - Name: players_role
    Packages:
      - build-essential
      - gdb
      - strace
      - git
    Recipes: 
      - sshd_password_login
      - strace
      - wheelie

Groups: 
  - Name: Player
    Access: 
      Administrator: 
        - Player_Instance
      User: 
        - NAT_Instance
    Users:
      - Login: instructor
        Password: vLCu3Crf

Scenarios: 
  - Description: "This game uses strace to examine executable files."
    Name: Strace
    Instructions: Players will first ssh into the NAT (listed under Instances below) using it's Public IP Address. You can view login credentials under Players. After logging into the NAT players need to ssh into the Player_Instance using it's IP Address. From there players can answer the questions under Scoring.

Clouds: 
  - Name: Cloud_1
    CIDR_Block: 10.0.0.0/16
    Scenario: Strace

Subnets: 
  - Name: Player_Subnet
    Cloud: Cloud_1
    CIDR_Block: 10.0.128.0/24

  - Name: NAT_Subnet
    Cloud: Cloud_1
    CIDR_Block: 10.0.129.0/24
    Internet_Accessible: true

Instances: 
  - Name: NAT_Instance
    Subnet: NAT_Subnet
    OS: nat
    IP_Address: 10.0.129.5
    Internet_Accessible: true
    Roles: 
      - NAT

  - Name: Player_Instance
    Subnet: Player_Subnet
    OS: ubuntu
    IP_Address: 10.0.128.4
    Roles: 
      - players_role

Questions:
  - Question: What is the second directory your shell looks in for executables?
    Answer: /usr/local/bin | /usr/local/bin/

  - Question: Where are executalbes which are needed in single user mode and to bring the system up or repair it located?
    Answer: /bin | /bin/

  - Question: Where is the strace program located?
    Answer: /usr/bin | /usr/bin/ | /usr/bin/strace | /usr/bin/strace

  - Question: What option in strace counts the number of syscalls?
    Answer: -c

  - Question: How many calls to 'open' does '/tmp/strace0' make?
    Answer: 158

  - Question: The file "/tmp/strace1" contains output from strace. What is the name of the executable used in the trace.
    Answer: cat | /bin/cat | /bin/cat/

  - Question: The file "/tmp/strace1" contains output from strace. What is the name of the executable used in the trace.
    Answer: cat | /bin/cat | /bin/cat/

  - Question: "The file '/tmp/strace2' contains output from strace. This time the 'execv' system call information has been removed. What is the name of the executable used in the trace. Hint: look for unique system calls. Also 'open' and 'write'system calls often provide valuable information for identifying an executable. Use grep too filter the strace file."
    Answer: chmod | /bin/chmod | /bin/chmod

  - Question: Same question as above for "/tmp/strace3".
    Answer: telnet | /bin/telnet | /bin/telnet/

  - Question: The file "/tmp/strace_mixed" contains non-sequential interleaved output from two different strace outputs. What are the two executables traced?
    Answer: ls | /bin/ls | /bin/ls/ && passwd | /bin/passwd | /bin/passwd/